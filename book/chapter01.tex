\chapter{Առաջին ծրագիրը}

\begin{epigraph}
Սի լեզվով գրված առաջին ծրագիրը, դրա խմբագրումը,
թարգմանումը և կատարումը։
\end{epigraph}

Մի հայտնի ու իմաստուն գրքում \cite{krc} ասվում է, որ ծրագրավորման
լեզուն սովորելու ամենալավ եղանակը դրանով ծրագրեր գրելն է։ Ես հետևում
եմ այդ խորհրդին ու Սի լեզվի մասին առաջին իմ \emph{զրույցը} սկսում
եմ մի կարճ ծրագրով։ Այն պետք է արտածման ստանդարտ հոսքին դուրս բերի
երկու տող՝ «Ողջո՜ւյն։» և «Այդ ե՛ս եմ՝ քո առաջին Սի ծրագիրը։»։

\begin{Verbatim}
/* Առաջին ծրագիրը */
#include <stdio.h>

int main()
{
    puts("Ողջո՜ւյն։");
    puts("Այդ ե՛ս եմ՝ քո առաջին Սի ծրագիրը։");
    return 0;
}
\end{Verbatim}

Առաջին տողում գրված \code{/*} նիշերով սկսվող և \code{*/} նիշերով
ավարտվող տեքստը \emph{մեկնաբանություն}\index{մեկնաբանություն} է։
Մեկնաբանությունները նախատեսված են մարդկանց հա\-մար. դրանք
ամբողջությամբ անտեսվում են կոմպիլյատորի կողմից։ Սի լեզվում
մեկնաբանություններ կարելի է գրել նաև C++ լեզվից փոխանցված եղանակով.
այդպիսի մեկնաբանությունները սկսվում են \code{//} նիշերով և տարածվում
են մինչև տողի վերջը։

Երկրորդ տողի \code{\#include <stdio.h>} արտահայտությունը պահանջում
է կոմ\-պիլյացիայից առաջ \code{prog01.c} ֆայլին կցել գրադարանային
\code{stdio.h} ֆայլը։ Վերջինս պարունակում է տվյալների ներմուծման ու
արտածման համար նա\-խատեսված ստանդարտ ֆունկցիաների, կառուցվածքների և
այլ ծրագրային տարրերի հայտարարությունները։ Այստեղ առաջ անցնելով
նշենք, որ \code{\#} նիշով սկսվող բոլոր հրահանգները նախատեսված են
\emph{նախապրոցեսորի}\index{նախապրոցեսոր} (\emph{preprocessor}) համար,
և Սի լեզվի մաս չեն կազմում (տե՛ս Զրույց~\ref{cha:prepr})։

Չորրորդ տողում գրված է Սի ծրագրերի \emph{մուտքի կետ}՝ կատարման
սկիզբ, հանդիսացող \code{main}\index{main} ֆունկցիայի վերնագիրը։
Տվյալ դեպքում \code{main} ֆունկցիան արգումենտներ չի սպասում՝ նրա
արգումենտների ցուցակը դատարկ է, բայց վերադարձնում է \code{int}
(integer, ամբողջ թիվ) տիպի արժեք։ Սի լեզվով գրված բոլոր ծրագրերն
իրենց աշխատանքը սկսում են հենց \code{main} ֆունկցիայից։ Ավելի
պատկերավոր ասած՝ \code{main} ֆունկցիան կանչվում է օպերացիոն
համակարգի կողմից, իսկ նրա վերադարձրած արժեքը օպերացիոն համակարգը
մեկնաբա\-նում է որպես կատարվող ծրագրի հաջող կամ անհաջող ավարտի
հայտանիշ։ Պայ\-մանավորվածություն կա, որ \code{0} արժեք են
վերադարձնում հաջող ավարտված ծրագրերը, իսկ զրոյից տարբեր արժեք՝
անհաջող ավարտվածները։

Սի ֆունկցիայի \emph{մարմինը}՝ այն հրամանների հաջորդականությունը,
որոնցով որոշվում է ֆունկցիայի վարքը, պարփակված է ֆունկցիայի
վերնագրին հաջոր\-դող \code{\{} և \code{\}} փակագծերի մեջ։ Մեր
օրինակի հինգերորդ տողում սկսվում է և իներորդ տողում ավարտվում է
\code{main} ֆունկցիայի մարմինը։

Վեցերորդ և յոթերորդ տողերում օգտագործված է \code{stdio}
(standard input-output) գրադարանի \code{puts}\index{puts}
(put string -- արտածել տողը) ֆունկցիան։ Այն իր արգումեն\-տում
ստանում է նիշերի տող և այդ տողն արտածում է \code{stdout}
արտածման ստան\-դարտ հոսքին։

Ութերորդ տողում օգտագործված \code{return}\index{return} հրամանը
նախատեսված է ֆունկ\-ցիայից արժեք վերադարձնելու համար (սրա մասին
դեռ շատ կխոսենք)։ Այստեղ \code{return} հրամանով \code{main} ֆունկցիան
վերադարձնում է \(0\) արժեքը, որը, ինչպես արդեն նշեցինք, ցուց է
տալիս ծրագրի՝ այդ կետում հաջող ավարտված լինելը։

Վերջապես նշենք նաև մի կարևոր բան. բոլոր հրամաններն ավարտվում
են \verb|;| (կետ-ստորակետ) նիշով։

\smallskip
Հիմա փորձենք «կյանք տալ» այս ծրագրին. այսինքն՝ \emph{կատարել} այն։
Դրա համար տեսնենք թե ինչ կյանք է ապրում ծրագիրը՝ տեքստի պատրաստումից
մինչև կատարում։

Ժամանակակից ծրագրավորողը քոմփյութերային ծրագրերի մշակման ընթաց\-քում
կատարում է, կրկնում է հետևյալ հիմնական քայլերը.

\textbf{Ծրագրի տեքստի խմբագրում} (editing) --- մի որևէ տեքստային
խմբագրիչով, կամ ծրագրերի մշակման ինտեգրացված միջավայրում (IDE,
integrated development environment) ստեղծվում է ծրագրի տեքստը և
պահպանվում է ֆայլի մեջ։ Սի լեզվով գրված ծրագրերի ֆայլերը հիմնականում
ունենում են \code{.c} վերջավորութ\-յուն, իսկ հայտարարությունների
ֆայլերը՝ \code{.h} վերջավորություն։

Տվյալ դեպքում տեքստային խմբագրիչում ներմուծում եմ վերը բերված ծրագրի
տեքստը և այն պահպանում եմ \code{prog01.c} անունով ֆայլում։

%![տեքստային-խմբագրիչի-նկար](vcl-editor.png)

\textbf{Թարգմանություն} կամ \textbf{կոմպիլյացիա} (compilation) ---
թարգմանող ծրագրի՝ \emph{կոմպիլյատորի} միջոցով ծրագրի տեքստային
ներկայացումից կառուցվում է կոնկտրետ սարքակազմի վրա և կոնկրետ
օպերացիոն համակարգում աշխատող, մեքենայական կոդը պարունակող
\emph{կատարվող մոդուլը} (executable module)։

Ծրագրի \code{prog01.c} ֆայլը (source file) թարգմանում եմ այսպես.

\begin{Verbatim}
$ cc prog01.c -o prog01
\end{Verbatim}

Այս հրամանում կոմպիլյատորին տրվող \code{-o} պարամետրի արգումենտով
որոշվում է ստեղծվելիք կատարվող մոդուլի անունը։ \code{-o} պարամետրի
բացակայության դեպքում կոմպիլյատորը կստեղծի \code{a.out} անունով
կատարվող ֆայլ։ Եթե ծրագրի տեքստը սխալներ չի պարունակում, և կոմպիլյացիան
հաջող է անցնում, ապա ստեղծվում է \code{prog01} կատարվող մոդուլը։

\textbf{Թեսթավորում} (testing) և \textbf{կատարում} (execution) ---
օպերացիոն համակարգը կատարվող մոդուլը բեռնում է մեքենայի հիշողության
մեջ և սկսում է կատարել այն։ Ինչպես արդեն նշվեց վերեւում, կատարումը
սկսվում է \code{main} ֆունկցիայից։ Թեսթավորման ժամանակ ծրագիրը
կատարվում է նախապես որոշված տվյալներով ու սցենարներով և դրա ստեղծած
արդյունքները համեմատվում են արդյունքների հետ։ Կատարման ժամանակ ծրագիրը
պարզապես շահագործվում է ըստ իր նշանակության։

\code{prog01} մոդուլն աշխատեցնելու համար պարզապես պետք է հրամանային
տողից այն գործարկել ինչպես որևէ այլ ծրագիր.

\begin{Verbatim}
$ ./prog01
Ողջո՜ւյն։
Այդ ե՛ս եմ՝ քո առաջին C ծրագիրը։
\end{Verbatim}

Հիմա, եթե \code{echo} հրամանով արտածենք Bash-ի \code{\$?}
փսոևդոփոփոխականը, որը պարունակում է վերջին աշխատած ծրագիր ավարտի
կոդը, ապա կստանանք \code{0} արժեքը։ Այս \code{0}-ն հենց \code{main}
ֆունկցիայից \code{return} հրամանով վերադարձրած արժեքն է։

\begin{Verbatim}
$ echo $?
0
\end{Verbatim}

Համոզվելու համար կարող ենք, օրինակ, \code{return 0;} հրամանը
ծրագրում փոխարինել, \code{return 7;} հրամանով, ապա կատարելուց
հետո նորից ստուգել \code{\$?}-ի արժեքը։

\textbf{Շտկում} (debugging) --- եթե կոմպիլյացիայի, թեսթավորման
կամ կատարման քայլերում ծրագրում հայտնաբերվել են բառային (լեքսիկական),
շարահյուսական կամ տրամաբանական սխալներ,  ապա շտկումներ են կատարվում
ծրագրի տեքստում և կոմպիլյացիայի, կատարման կամ թեսթավորման քայլերը
նորից կրկնվում են անհրաժեշտ հաջորդականությամբ։

Այս պարզագույն օրինակում, իհարկե, դժվար է ինչ-որ մի տեխնիկական
սխալ անել։ Բայց ենթադրենք, թե մոռացել ենք 6-րդ տողն ավարտող
\code{;} նիշը։ Կոմպիլյատորը կհայտնաբերի սխալը և կարտածի
համապատասխան հաղորդագրություն.

\begin{Verbatim}
prog01.c: In function ‘main’:
   prog01.c:7:4: error: expected ‘;’ before ‘puts’
   puts("Այդ ե՛ս եմ՝ քո առաջին C ծրագիրը։");
   ^~~~
\end{Verbatim}

Այս հաղորդագրությունն ասում է, որ \code{prog01.c} ֆայլի 7-րդ տողի 4-րդ
դիրքի մոտ՝ \code{puts} բառից առաջ սպասվում է \code{;} նիշը։
